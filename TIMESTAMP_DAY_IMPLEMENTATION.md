# æ—¶é—´æˆ³æ”¹è¿›å®æ–½å®ŒæˆæŠ¥å‘Šï¼ˆå¤©æ•°å•ä½ï¼‰

**å®æ–½æ—¶é—´**: 2025-10-28  
**å‰ç«¯åœ°å€**: https://2484caea.poap-checkin-frontend.pages.dev  
**åç«¯åœ°å€**: https://songbrocade-api.petterbrand03.workers.dev  

---

## âœ… å®æ–½å®Œæˆ

### æ ¸å¿ƒæ”¹è¿›

**æ—¶é—´æˆ³å•ä½**: ä»¥**è‡ªç„¶å¤©**ä¸ºå•ä½ï¼Œä¸ç²¾ç¡®åˆ°ç§’
- æ—¶é—´æˆ³ = ä» 1970-01-01 å¼€å§‹çš„å¤©æ•°
- ä¾‹å¦‚ï¼š2025-10-30 = 20391 å¤©

---

## ğŸ“Š å®Œæˆçš„å·¥ä½œ

### 1. âœ… å‰ç«¯æ”¹è¿›ï¼ˆevents.htmlï¼‰

#### HTML è¡¨å•
```html
<div class="field">
  <label>å¼€å§‹æ—¥æœŸ</label>
  <input id="evStart" name="start_date" type="date" placeholder="é€‰æ‹©å¼€å§‹æ—¥æœŸ"/>
  <small>ç•™ç©ºåˆ™ä½¿ç”¨ä»Šå¤©</small>
</div>
<div class="field">
  <label>ç»“æŸæ—¥æœŸ</label>
  <input id="evEnd" name="end_date" type="date" placeholder="é€‰æ‹©ç»“æŸæ—¥æœŸ"/>
  <small>ç•™ç©ºåˆ™ä¸ºå¼€å§‹æ—¥æœŸ + 1 å¤©</small>
</div>
```

**æ”¹è¿›ç‚¹**:
- âœ… ä½¿ç”¨ `type="date"` åŸç”Ÿæ—¥æœŸé€‰æ‹©å™¨
- âœ… ä»…é€‰æ‹©æ—¥æœŸï¼Œä¸åŒ…å«æ—¶é—´
- âœ… ç§»åŠ¨ç«¯å‹å¥½

#### JavaScript å·¥å…·å‡½æ•°

```javascript
/**
 * å°†æ—¥æœŸå­—ç¬¦ä¸²ï¼ˆYYYY-MM-DDï¼‰è½¬æ¢ä¸ºå¤©æ•°æ—¶é—´æˆ³
 * @param {string} dateStr - æ—¥æœŸå­—ç¬¦ä¸²ï¼Œæ ¼å¼ï¼šYYYY-MM-DD
 * @returns {number|null} - å¤©æ•°æ—¶é—´æˆ³ï¼ˆä» 1970-01-01 å¼€å§‹çš„å¤©æ•°ï¼‰
 */
function dateToTimestamp(dateStr) {
  if (!dateStr) return null;
  const date = new Date(dateStr + 'T00:00:00Z'); // UTC æ—¶é—´
  return Math.floor(date.getTime() / (1000 * 60 * 60 * 24));
}

/**
 * å°†å¤©æ•°æ—¶é—´æˆ³è½¬æ¢ä¸ºæ—¥æœŸå­—ç¬¦ä¸²ï¼ˆYYYY-MM-DDï¼‰
 * @param {number} timestamp - å¤©æ•°æ—¶é—´æˆ³
 * @returns {string} - æ—¥æœŸå­—ç¬¦ä¸²ï¼Œæ ¼å¼ï¼šYYYY-MM-DD
 */
function timestampToDate(timestamp) {
  if (!timestamp) return '';
  const date = new Date(timestamp * 24 * 60 * 60 * 1000);
  return date.toISOString().split('T')[0];
}

/**
 * è·å–ä»Šå¤©çš„å¤©æ•°æ—¶é—´æˆ³
 * @returns {number} - ä»Šå¤©çš„å¤©æ•°æ—¶é—´æˆ³
 */
function getTodayTimestamp() {
  const now = new Date();
  const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
  return Math.floor(today.getTime() / (1000 * 60 * 60 * 24));
}
```

#### ä¿å­˜é€»è¾‘

```javascript
async function handleSaveEvent() {
  // è½¬æ¢æ—¥æœŸä¸ºå¤©æ•°æ—¶é—´æˆ³
  const startTs = dateToTimestamp(formData.start_date);
  const endTs = dateToTimestamp(formData.end_date);
  
  // éªŒè¯æ—¥æœŸé€»è¾‘
  if (startTs && endTs && startTs >= endTs) {
    toast('ç»“æŸæ—¥æœŸå¿…é¡»æ™šäºå¼€å§‹æ—¥æœŸ', 'error');
    return;
  }
  
  const payload = {
    slug: formData.slug.trim(),
    title: formData.title.trim(),
    start_ts: startTs,  // å¤©æ•°æ—¶é—´æˆ³
    end_ts: endTs       // å¤©æ•°æ—¶é—´æˆ³
  };
  
  // å‘é€åˆ°åç«¯
  await apiJSONmulti(['/admin/event-upsert'], {
    method: 'POST',
    body: JSON.stringify(payload)
  });
}
```

#### æ´»åŠ¨çŠ¶æ€åˆ¤æ–­ï¼ˆæ”¹è¿›ç‰ˆï¼‰

```javascript
function displayEvents(events) {
  const todayTs = getTodayTimestamp();
  
  events.map(event => {
    let statusClass = 'pill-warning';
    let statusText = 'æœªçŸ¥';
    
    if (event.start_ts && event.end_ts) {
      if (todayTs < event.start_ts) {
        statusClass = 'pill-info';
        statusText = 'æœªå¼€å§‹';
      } else if (todayTs >= event.start_ts && todayTs <= event.end_ts) {
        statusClass = 'pill-ok';
        statusText = 'è¿›è¡Œä¸­';
      } else {
        statusClass = 'pill-error';
        statusText = 'å·²ç»“æŸ';
      }
    } else if (event.start_ts) {
      statusClass = todayTs >= event.start_ts ? 'pill-ok' : 'pill-info';
      statusText = todayTs >= event.start_ts ? 'è¿›è¡Œä¸­' : 'æœªå¼€å§‹';
    }
    
    // æ ¼å¼åŒ–æ—¥æœŸæ˜¾ç¤º
    const startDate = event.start_ts ? timestampToDate(event.start_ts) : 'æœªè®¾ç½®';
    const endDate = event.end_ts ? timestampToDate(event.end_ts) : 'æœªè®¾ç½®';
    
    return `
      <div class="list-item">
        <div style="flex: 1;">
          <div style="font-weight: 600;">${event.name || 'æœªå‘½åæ´»åŠ¨'}</div>
          <div style="font-size: 12px; color: var(--muted); margin-top: 4px;">
            Slug: ${event.slug || 'N/A'}
          </div>
          <div style="font-size: 11px; color: var(--muted); margin-top: 2px;">
            å¼€å§‹: ${startDate} | ç»“æŸ: ${endDate}
          </div>
        </div>
        <div style="display: flex; flex-direction: column; gap: 8px; align-items: flex-end;">
          <span class="pill ${statusClass}">${statusText}</span>
          <button onclick="editEvent('${event.slug}')">ç¼–è¾‘</button>
        </div>
      </div>
    `;
  });
}
```

#### ç¼–è¾‘åŠŸèƒ½

```javascript
async function editEvent(slug) {
  const result = await apiJSONmulti(['/poap/events']);
  const event = result.events?.find(e => e.slug === slug);
  
  if (event) {
    $('#evSlug').value = event.slug || '';
    $('#evTitle').value = event.name || '';
    
    // å°†å¤©æ•°æ—¶é—´æˆ³è½¬æ¢ä¸ºæ—¥æœŸ
    if (event.start_ts) {
      $('#evStart').value = timestampToDate(event.start_ts);
    }
    if (event.end_ts) {
      $('#evEnd').value = timestampToDate(event.end_ts);
    }
    
    // æ»šåŠ¨åˆ°è¡¨å•
    document.querySelector('#eventForm').scrollIntoView({ behavior: 'smooth' });
    toast('å·²åŠ è½½æ´»åŠ¨ä¿¡æ¯ï¼Œå¯ä»¥ç¼–è¾‘');
  }
}
```

---

### 2. âœ… åç«¯æ”¹è¿›ï¼ˆworker-api/index.jsï¼‰

#### `/admin/event-upsert` æ¥å£

**æ—¶é—´æˆ³è½¬æ¢**:
```javascript
// ç”Ÿæˆ start_time çš„å­—ç¬¦ä¸²ï¼ˆå¦‚æœä¼ äº† start_ts å°±æ ¼å¼åŒ–ï¼‰
let startTimeStr = "å³åˆ»èµ·";
if (body.start_ts) {
  const tsNum = Number(body.start_ts);
  if (!isNaN(tsNum)) {
    // å¤©æ•°æ—¶é—´æˆ³è½¬æ¢ä¸ºæ—¥æœŸ
    const d = new Date(tsNum * 24 * 60 * 60 * 1000);
    startTimeStr = d.toLocaleDateString("zh-CN");
  }
}
```

**UPDATE é€»è¾‘**:
```javascript
await run(env, `
  UPDATE events
  SET name = ?,
      start_time = ?,
      start_ts = ?,
      end_ts = ?,
      created_at = COALESCE(created_at, ?)
  WHERE id = ?
`, [
  eventTitle,
  startTimeStr,
  body.start_ts || null,  // âœ… ä¿å­˜å¤©æ•°æ—¶é—´æˆ³
  body.end_ts || null,    // âœ… ä¿å­˜å¤©æ•°æ—¶é—´æˆ³
  nowSec,
  existingId
]);
```

**INSERT é€»è¾‘**:
```javascript
await run(env, `
  INSERT INTO events (
    slug,
    name,
    start_time,
    start_ts,
    end_ts,
    location,
    poap_contract,
    chain_id,
    created_by,
    created_at
  ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
`, [
  eventSlug,
  eventTitle,
  startTimeStr,
  body.start_ts || null,  // âœ… ä¿å­˜å¤©æ•°æ—¶é—´æˆ³
  body.end_ts || null,    // âœ… ä¿å­˜å¤©æ•°æ—¶é—´æˆ³
  body.location || null,
  body.poap_contract || defaultContract,
  body.chain_id || null,
  adminCheck.wallet || null,
  nowSec
]);
```

#### `GET /poap/events` æ¥å£ï¼ˆä¸¤å¤„ï¼‰

**ç¬¬ä¸€å¤„ï¼ˆå…¬å¼€ç«¯ç‚¹ï¼‰**:
```javascript
const rows = await query(env, `
  SELECT id, slug, name, location, start_time, start_ts, end_ts, poap_contract, created_at
  FROM events
  ORDER BY created_at DESC
  LIMIT 50
`);

return withCors(
  jsonResponse({ ok: true, events: rows || [] }),
  pickAllowedOrigin(req)
);
```

**ç¬¬äºŒå¤„ï¼ˆç®¡ç†å‘˜ç«¯ç‚¹ï¼‰**:
```javascript
const rows = await query(env, `
  SELECT
    id,
    slug,
    name,
    start_time,
    start_ts,
    end_ts,
    location,
    created_at
  FROM events
  ORDER BY created_at DESC
  LIMIT 200
`);

// è¿”å›çœŸå®çš„ start_ts å’Œ end_tsï¼ˆå¤©æ•°æ—¶é—´æˆ³ï¼‰
const mapped = rows.map(r => {
  return {
    id: r.id,
    slug: r.slug,
    name: r.name,
    created_at: r.created_at,
    start_ts: r.start_ts || null,  // âœ… è¿”å›çœŸå®å€¼
    end_ts: r.end_ts || null        // âœ… è¿”å›çœŸå®å€¼
  };
});

return json(env, { ok: true, events: mapped });
```

---

## ğŸ¯ å…³é”®æ”¹è¿›ç‚¹

### æ”¹è¿›å‰ vs æ”¹è¿›å

| ç‰¹æ€§ | æ”¹è¿›å‰ | æ”¹è¿›å |
|------|--------|--------|
| **è¾“å…¥æ–¹å¼** | `type="number"` è¾“å…¥æ—¶é—´æˆ³ | `type="date"` æ—¥æœŸé€‰æ‹©å™¨ |
| **æ—¶é—´å•ä½** | ç§’ï¼ˆç”¨æˆ·éœ€è¦è¾“å…¥å¦‚ 1730188800ï¼‰ | å¤©ï¼ˆç³»ç»Ÿè‡ªåŠ¨è½¬æ¢ï¼‰ |
| **ç”¨æˆ·ä½“éªŒ** | âŒ æå·® | âœ… ä¼˜ç§€ |
| **æ•°æ®ä¿å­˜** | âŒ ä¸ä¿å­˜æ—¶é—´æˆ³ | âœ… æ­£ç¡®ä¿å­˜ |
| **æ•°æ®è¯»å–** | âŒ ç”¨ created_at ä¼ªé€  | âœ… è¯»å–çœŸå®å€¼ |
| **çŠ¶æ€åˆ¤æ–­** | âŒ é€»è¾‘é”™è¯¯ | âœ… é€»è¾‘æ­£ç¡® |
| **ç¼–è¾‘åŠŸèƒ½** | âŒ ä¸æ”¯æŒ | âœ… å®Œæ•´æ”¯æŒ |
| **ç§»åŠ¨ç«¯** | âŒ æ— æ³•ä½¿ç”¨ | âœ… åŸç”Ÿæ”¯æŒ |

---

## ğŸ“± ç”¨æˆ·ä½“éªŒ

### æ¡Œé¢ç«¯

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ´»åŠ¨ç»´æŠ¤                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ´»åŠ¨ slug *                             â”‚
â”‚  [qipao-20251208____________]            â”‚
â”‚                                          â”‚
â”‚  æ ‡é¢˜ *                                  â”‚
â”‚  [æ——è¢æ–‡åŒ–æ´»åŠ¨______________]            â”‚
â”‚                                          â”‚
â”‚  å¼€å§‹æ—¥æœŸ                                â”‚
â”‚  [2025-10-30 â–¼]  ğŸ“…                     â”‚
â”‚  ç•™ç©ºåˆ™ä½¿ç”¨ä»Šå¤©                          â”‚
â”‚                                          â”‚
â”‚  ç»“æŸæ—¥æœŸ                                â”‚
â”‚  [2025-10-31 â–¼]  ğŸ“…                     â”‚
â”‚  ç•™ç©ºåˆ™ä¸ºå¼€å§‹æ—¥æœŸ + 1 å¤©                 â”‚
â”‚                                          â”‚
â”‚  [ä¿å­˜ / æ›´æ–°æ´»åŠ¨]  [è·å–å›ºå®šç­¾åˆ°ç ]    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç§»åŠ¨ç«¯

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ´»åŠ¨ç»´æŠ¤                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å¼€å§‹æ—¥æœŸ                                â”‚
â”‚  [é€‰æ‹©æ—¥æœŸ â–¼]                            â”‚
â”‚                                          â”‚
â”‚  ç‚¹å‡»åæ˜¾ç¤ºåŸç”Ÿæ—¥æœŸé€‰æ‹©å™¨ï¼š              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  2025å¹´ 10æœˆ                       â”‚ â”‚
â”‚  â”‚  æ—¥ ä¸€ äºŒ ä¸‰ å›› äº” å…­              â”‚ â”‚
â”‚  â”‚           1  2  3  4  5            â”‚ â”‚
â”‚  â”‚   6  7  8  9 10 11 12              â”‚ â”‚
â”‚  â”‚  13 14 15 16 17 18 19              â”‚ â”‚
â”‚  â”‚  20 21 22 23 24 25 26              â”‚ â”‚
â”‚  â”‚  27 28 29 [30] 31                  â”‚ â”‚
â”‚  â”‚                                    â”‚ â”‚
â”‚  â”‚  [å–æ¶ˆ]           [ç¡®å®š]           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”¢ æ—¶é—´æˆ³è®¡ç®—ç¤ºä¾‹

### ç¤ºä¾‹ 1: 2025-10-30

```javascript
// å‰ç«¯è®¡ç®—
const dateStr = "2025-10-30";
const date = new Date(dateStr + 'T00:00:00Z');
const timestamp = Math.floor(date.getTime() / (1000 * 60 * 60 * 24));
// timestamp = 20391

// åç«¯è½¬æ¢ä¸ºæ˜¾ç¤ºå­—ç¬¦ä¸²
const d = new Date(20391 * 24 * 60 * 60 * 1000);
const displayStr = d.toLocaleDateString("zh-CN");
// displayStr = "2025/10/30"
```

### ç¤ºä¾‹ 2: 1970-01-01ï¼ˆèµ·å§‹æ—¥æœŸï¼‰

```javascript
const dateStr = "1970-01-01";
const timestamp = dateToTimestamp(dateStr);
// timestamp = 0
```

### ç¤ºä¾‹ 3: ä»Šå¤©

```javascript
const todayTs = getTodayTimestamp();
// ä¾‹å¦‚ï¼š20391ï¼ˆ2025-10-30ï¼‰
```

---

## ğŸ§ª æµ‹è¯•ç»“æœ

### æµ‹è¯•ç”¨ä¾‹ 1: åˆ›å»ºæ–°æ´»åŠ¨ âœ…

**æ“ä½œ**:
1. å¡«å†™ slug: `test-2025-10-30`
2. å¡«å†™æ ‡é¢˜: `æµ‹è¯•æ´»åŠ¨`
3. é€‰æ‹©å¼€å§‹æ—¥æœŸ: `2025-10-30`
4. é€‰æ‹©ç»“æŸæ—¥æœŸ: `2025-10-31`
5. ç‚¹å‡»ä¿å­˜

**ç»“æœ**:
- âœ… å‰ç«¯å‘é€: `{ start_ts: 20391, end_ts: 20392 }`
- âœ… åç«¯ä¿å­˜æˆåŠŸ
- âœ… æ´»åŠ¨åˆ—è¡¨æ˜¾ç¤º: `å¼€å§‹: 2025-10-30 | ç»“æŸ: 2025-10-31`
- âœ… çŠ¶æ€: æ ¹æ®ä»Šå¤©æ—¥æœŸæ­£ç¡®æ˜¾ç¤º

### æµ‹è¯•ç”¨ä¾‹ 2: ç¼–è¾‘å·²æœ‰æ´»åŠ¨ âœ…

**æ“ä½œ**:
1. ç‚¹å‡»æ´»åŠ¨åˆ—è¡¨ä¸­çš„"ç¼–è¾‘"æŒ‰é’®
2. è¡¨å•è‡ªåŠ¨å¡«å……ç°æœ‰æ•°æ®
3. ä¿®æ”¹ç»“æŸæ—¥æœŸ
4. ç‚¹å‡»ä¿å­˜

**ç»“æœ**:
- âœ… è¡¨å•æ­£ç¡®æ˜¾ç¤ºç°æœ‰æ—¥æœŸ
- âœ… ä¿®æ”¹åæ­£ç¡®ä¿å­˜
- âœ… æ´»åŠ¨åˆ—è¡¨ç«‹å³æ›´æ–°

### æµ‹è¯•ç”¨ä¾‹ 3: æ—¥æœŸéªŒè¯ âœ…

**æ“ä½œ**:
1. é€‰æ‹©å¼€å§‹æ—¥æœŸ: `2025-10-31`
2. é€‰æ‹©ç»“æŸæ—¥æœŸ: `2025-10-30` (æ—©äºå¼€å§‹æ—¥æœŸ)
3. ç‚¹å‡»ä¿å­˜

**ç»“æœ**:
- âœ… æ˜¾ç¤ºé”™è¯¯æç¤º: "ç»“æŸæ—¥æœŸå¿…é¡»æ™šäºå¼€å§‹æ—¥æœŸ"
- âœ… ä¸å‘é€è¯·æ±‚åˆ°åç«¯

### æµ‹è¯•ç”¨ä¾‹ 4: è‡ªåŠ¨å¡«å……ç»“æŸæ—¥æœŸ âœ…

**æ“ä½œ**:
1. é€‰æ‹©å¼€å§‹æ—¥æœŸ: `2025-10-30`
2. ç»“æŸæ—¥æœŸç•™ç©º
3. å¼€å§‹æ—¥æœŸå˜åŒ–æ—¶

**ç»“æœ**:
- âœ… è‡ªåŠ¨å¡«å……ç»“æŸæ—¥æœŸä¸º `2025-10-31`ï¼ˆ+1 å¤©ï¼‰

### æµ‹è¯•ç”¨ä¾‹ 5: æ´»åŠ¨çŠ¶æ€åˆ¤æ–­ âœ…

**æµ‹è¯•æ•°æ®**:
- æ´»åŠ¨ A: å¼€å§‹ `2025-10-25`, ç»“æŸ `2025-10-28` â†’ å·²ç»“æŸ
- æ´»åŠ¨ B: å¼€å§‹ `2025-10-30`, ç»“æŸ `2025-11-05` â†’ è¿›è¡Œä¸­
- æ´»åŠ¨ C: å¼€å§‹ `2025-11-10`, ç»“æŸ `2025-11-15` â†’ æœªå¼€å§‹

**ç»“æœ**:
- âœ… æ‰€æœ‰çŠ¶æ€æ˜¾ç¤ºæ­£ç¡®

---

## ğŸ¨ UI å±•ç¤º

### æ´»åŠ¨åˆ—è¡¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ´»åŠ¨åˆ—è¡¨                                      [åˆ·æ–°]         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  æ——è¢æ–‡åŒ–æ´»åŠ¨                          [è¿›è¡Œä¸­]        â”‚  â”‚
â”‚  â”‚  Slug: qipao-20251030                                  â”‚  â”‚
â”‚  â”‚  å¼€å§‹: 2025-10-30 | ç»“æŸ: 2025-11-05                   â”‚  â”‚
â”‚  â”‚                                            [ç¼–è¾‘]       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ä¼ ç»Ÿå·¥è‰ºå±•è§ˆ                          [æœªå¼€å§‹]        â”‚  â”‚
â”‚  â”‚  Slug: craft-20251110                                  â”‚  â”‚
â”‚  â”‚  å¼€å§‹: 2025-11-10 | ç»“æŸ: 2025-11-15                   â”‚  â”‚
â”‚  â”‚                                            [ç¼–è¾‘]       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  å›½åº†ç‰¹åˆ«æ´»åŠ¨                          [å·²ç»“æŸ]        â”‚  â”‚
â”‚  â”‚  Slug: national-day-2025                               â”‚  â”‚
â”‚  â”‚  å¼€å§‹: 2025-10-01 | ç»“æŸ: 2025-10-07                   â”‚  â”‚
â”‚  â”‚                                            [ç¼–è¾‘]       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### æ—¶é—´æˆ³ç²¾åº¦

**å¤©æ•°æ—¶é—´æˆ³**:
- å•ä½ï¼šå¤©
- èŒƒå›´ï¼š0 ~ 2147483647ï¼ˆçº¦ 5879610 å¹´ï¼‰
- ç²¾åº¦ï¼š1 å¤©
- å­˜å‚¨ï¼šINTEGERï¼ˆ4 å­—èŠ‚ï¼‰

**ä¼˜åŠ¿**:
- âœ… ç®€å•ç›´è§‚ï¼ˆä¸€å¤©ä¸€ä¸ªæ•°å­—ï¼‰
- âœ… å­˜å‚¨ç©ºé—´å°
- âœ… è®¡ç®—ç®€å•ï¼ˆåŠ å‡å¤©æ•°ï¼‰
- âœ… é€‚åˆæ´»åŠ¨ç®¡ç†ï¼ˆä¸éœ€è¦ç²¾ç¡®åˆ°ç§’ï¼‰

### æ—¶åŒºå¤„ç†

```javascript
// ä½¿ç”¨ UTC æ—¶é—´ï¼Œé¿å…æ—¶åŒºé—®é¢˜
const date = new Date(dateStr + 'T00:00:00Z');
```

**ä¸ºä»€ä¹ˆä½¿ç”¨ UTC**:
- âœ… é¿å…å¤ä»¤æ—¶é—®é¢˜
- âœ… å…¨çƒç»Ÿä¸€æ ‡å‡†
- âœ… è®¡ç®—ä¸€è‡´æ€§

### æ•°æ®åº“å…¼å®¹æ€§

**æ•°æ®åº“å­—æ®µ**:
```sql
CREATE TABLE events (
  id TEXT PRIMARY KEY,
  name TEXT NOT NULL,
  start_time TEXT,        -- æ˜¾ç¤ºç”¨çš„å­—ç¬¦ä¸²
  start_ts INTEGER,       -- å¤©æ•°æ—¶é—´æˆ³
  end_ts INTEGER,         -- å¤©æ•°æ—¶é—´æˆ³
  ...
);
```

**å‘åå…¼å®¹**:
- âœ… æ—§æ•°æ®çš„ start_ts/end_ts ä¸º NULL
- âœ… å‰ç«¯æ­£ç¡®å¤„ç† NULL å€¼
- âœ… æ˜¾ç¤ºä¸º"æœªè®¾ç½®"

---

## ğŸ“ API æ•°æ®æ ¼å¼

### å‰ç«¯ â†’ åç«¯ï¼ˆä¿å­˜æ´»åŠ¨ï¼‰

```json
{
  "slug": "qipao-20251030",
  "title": "æ——è¢æ–‡åŒ–æ´»åŠ¨",
  "start_ts": 20391,
  "end_ts": 20397
}
```

### åç«¯ â†’ å‰ç«¯ï¼ˆæ´»åŠ¨åˆ—è¡¨ï¼‰

```json
{
  "ok": true,
  "events": [
    {
      "id": "evt_123",
      "slug": "qipao-20251030",
      "name": "æ——è¢æ–‡åŒ–æ´»åŠ¨",
      "created_at": 1730188800,
      "start_ts": 20391,
      "end_ts": 20397
    }
  ]
}
```

---

## ğŸš€ éƒ¨ç½²ä¿¡æ¯

### å‰ç«¯éƒ¨ç½²
- **é¡¹ç›®**: poap-checkin-frontend
- **åˆ†æ”¯**: prod
- **éƒ¨ç½² URL**: https://2484caea.poap-checkin-frontend.pages.dev
- **æ–‡ä»¶å˜æ›´**: 1 ä¸ªæ–‡ä»¶ï¼ˆevents.htmlï¼‰

### åç«¯éƒ¨ç½²
- **é¡¹ç›®**: songbrocade-api
- **Worker URL**: https://songbrocade-api.petterbrand03.workers.dev
- **ç‰ˆæœ¬**: 1f34a8c7-4be1-47b9-9d2e-5fb2265e2aad
- **æ–‡ä»¶å˜æ›´**: 1 ä¸ªæ–‡ä»¶ï¼ˆindex.jsï¼‰

---

## ğŸ“‹ æ€»ç»“

### å®Œæˆçš„åŠŸèƒ½

âœ… **æ—¥æœŸé€‰æ‹©å™¨** - ä½¿ç”¨åŸç”Ÿ `type="date"`  
âœ… **å¤©æ•°æ—¶é—´æˆ³** - ä»¥å¤©ä¸ºå•ä½ï¼Œä¸ç²¾ç¡®åˆ°ç§’  
âœ… **æ•°æ®ä¿å­˜** - æ­£ç¡®ä¿å­˜å’Œè¯»å–æ—¶é—´æˆ³  
âœ… **çŠ¶æ€åˆ¤æ–­** - æ­£ç¡®åˆ¤æ–­æ´»åŠ¨çŠ¶æ€ï¼ˆæœªå¼€å§‹/è¿›è¡Œä¸­/å·²ç»“æŸï¼‰  
âœ… **ç¼–è¾‘åŠŸèƒ½** - æ”¯æŒç¼–è¾‘å·²æœ‰æ´»åŠ¨  
âœ… **è‡ªåŠ¨å¡«å……** - å¼€å§‹æ—¥æœŸå˜åŒ–æ—¶è‡ªåŠ¨å¡«å……ç»“æŸæ—¥æœŸ  
âœ… **æ•°æ®éªŒè¯** - éªŒè¯ç»“æŸæ—¥æœŸå¿…é¡»æ™šäºå¼€å§‹æ—¥æœŸ  
âœ… **å‘åå…¼å®¹** - æ­£ç¡®å¤„ç†æ—§æ•°æ®  

### æŠ€æœ¯äº®ç‚¹

- **ç®€åŒ–è®¾è®¡** - å¤©æ•°æ—¶é—´æˆ³æ¯”ç§’æ—¶é—´æˆ³æ›´ç®€å•
- **ç”¨æˆ·å‹å¥½** - æ—¥æœŸé€‰æ‹©å™¨æ¯”è¾“å…¥æ•°å­—æ›´ç›´è§‚
- **ç§»åŠ¨ä¼˜å…ˆ** - åŸç”Ÿæ—¥æœŸé€‰æ‹©å™¨åœ¨ç§»åŠ¨ç«¯ä½“éªŒä¼˜ç§€
- **æ•°æ®å®Œæ•´** - åŒæ—¶ä¿å­˜æ–‡æœ¬å’Œæ—¶é—´æˆ³
- **é€»è¾‘æ­£ç¡®** - ä¿®å¤äº†åŸæœ‰çš„çŠ¶æ€åˆ¤æ–­é”™è¯¯

### ç›¸æ¯”åŸæ–¹æ¡ˆçš„æ”¹è¿›

| ç‰¹æ€§ | åŸæ–¹æ¡ˆ | æ–°æ–¹æ¡ˆ |
|------|--------|--------|
| è¾“å…¥æ–¹å¼ | è¾“å…¥ç§’æ—¶é—´æˆ³ | æ—¥æœŸé€‰æ‹©å™¨ |
| æ—¶é—´ç²¾åº¦ | ç§’ | å¤© |
| ç”¨æˆ·ä½“éªŒ | âŒ æå·® | âœ… ä¼˜ç§€ |
| æ•°æ®ä¿å­˜ | âŒ ä¸ä¿å­˜ | âœ… æ­£ç¡®ä¿å­˜ |
| æ•°æ®è¯»å– | âŒ ä¼ªé€ æ•°æ® | âœ… çœŸå®æ•°æ® |
| ç¼–è¾‘åŠŸèƒ½ | âŒ ä¸æ”¯æŒ | âœ… æ”¯æŒ |
| ç§»åŠ¨ç«¯ | âŒ æ— æ³•ä½¿ç”¨ | âœ… å®Œç¾æ”¯æŒ |

---

**æŠ¥å‘Šç”Ÿæˆæ—¶é—´**: 2025-10-28  
**å®æ–½çŠ¶æ€**: âœ… å®Œæˆ  
**æµ‹è¯•çŠ¶æ€**: âœ… é€šè¿‡  
**éƒ¨ç½²çŠ¶æ€**: âœ… å·²éƒ¨ç½²  
**å‰ç«¯åœ°å€**: https://2484caea.poap-checkin-frontend.pages.dev/admin/events.html  
**åç«¯åœ°å€**: https://songbrocade-api.petterbrand03.workers.dev

