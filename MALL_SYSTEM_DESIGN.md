# 🛍️ 新商城系统设计文档

## 📋 系统概述

全新的4模块电商平台，包含：首页、互动中心、购物车、我的页面

---

## 🏗️ 系统架构

```
┌─────────────────────────────────────────┐
│           底部导航栏（固定）              │
│  [首页] [互动] [购物车] [我的]           │
└─────────────────────────────────────────┘
         ↓        ↓        ↓        ↓
    ┌────────┬────────┬────────┬────────┐
    │  首页   │ 互动中心│ 购物车  │ 我的   │
    └────────┴────────┴────────┴────────┘
```

---

## 📱 模块详情

### 1. 首页 (`/mall/index.html`) ✅ 已完成

#### 布局结构
```
┌─────────────────────────────────┐
│  顶部搜索栏（固定）               │
├─────────────────────────────────┤
│  导航栏（横向滚动）               │
│  [全部][旗袍][陶瓷][丝绸]...     │
├─────────────────────────────────┤
│  英雄轮播（自动播放）             │
│  • 传统工艺                      │
│  • 限量手作                      │
│  • 文化出海                      │
├─────────────────────────────────┤
│  入口卡片网格（4x2）             │
│  [全部商品][每日签到][空投领取]  │
│  [认证匠人][非遗项目][社区治理]  │
│  [我的奖励][积分中心]            │
├─────────────────────────────────┤
│  热门商品（2列网格）             │
│  [商品1] [商品2]                │
│  [商品3] [商品4]                │
├─────────────────────────────────┤
│  新品上架（2列网格）             │
├─────────────────────────────────┤
│  链上认证（2列网格）             │
└─────────────────────────────────┘
```

#### 核心功能
- ✅ 顶部搜索栏（实时搜索）
- ✅ 分类导航（横向滚动）
- ✅ 英雄轮播（Swiper.js，自动播放）
- ✅ 8个功能入口卡片
- ✅ 3个商品分区（热门、新品、认证）
- ✅ 底部导航栏（4个主要模块）

#### 技术实现
```javascript
// Swiper 轮播
const swiper = new Swiper('.hero-swiper', {
  loop: true,
  autoplay: {
    delay: 3000,
    disableOnInteraction: false,
  },
  pagination: {
    el: '.swiper-pagination',
    clickable: true,
  },
});

// 动态加载商品
async function loadProducts() {
  const res = await fetch(API_BASE + "/products");
  const data = await res.json();
  // 渲染热门、新品、认证商品
}
```

---

### 2. 互动中心 (`/mall/community.html`) ✅ 已完成

#### 设计理念
类似 Twitter/微博 的社交平台，用户可以：
- 📝 发布动态（文字 + 图片）
- ❤️ 点赞、评论、分享
- 👤 查看用户主页
- #️⃣ 话题标签

#### 布局结构
```
┌─────────────────────────────────┐
│  顶部标题栏                      │
│  互动中心                        │
├─────────────────────────────────┤
│  ┌───────────────────────────┐  │
│  │ 用户头像 | 用户名 | 时间   │  │
│  │ 帖子内容...                │  │
│  │ [图片1] [图片2] [图片3]   │  │
│  │ ❤️ 128  💬 32  🔗 分享    │  │
│  └───────────────────────────┘  │
│  ┌───────────────────────────┐  │
│  │ 另一条帖子...              │  │
│  └───────────────────────────┘  │
├─────────────────────────────────┤
│  [+] 发帖按钮（右下角浮动）      │
└─────────────────────────────────┘
```

#### 核心功能
- ✅ 帖子列表（无限滚动）
- ✅ 发帖功能（文字 + 图片）
- ✅ 点赞、评论、分享
- ✅ 用户头像和信息
- ✅ 时间显示
- ✅ 图片网格展示（最多9张）

#### 帖子数据结构
```javascript
{
  id: "post_123",
  user: {
    id: "user_456",
    name: "张师傅",
    avatar: "avatar_url"
  },
  content: "今天完成了一件苏绣作品...",
  images: ["img1.jpg", "img2.jpg"],
  likes: 128,
  comments: 32,
  shares: 15,
  created_at: "2025-10-30T12:00:00Z"
}
```

---

### 3. 购物车 (`/mall/cart.html`) 🔄 待创建

#### 布局结构
```
┌─────────────────────────────────┐
│  顶部标题栏                      │
│  购物车 (3)                      │
├─────────────────────────────────┤
│  ┌───────────────────────────┐  │
│  │ [✓] [图片] 商品名称        │  │
│  │     ¥价格 x 数量           │  │
│  │     [- 1 +] [删除]        │  │
│  └───────────────────────────┘  │
│  ┌───────────────────────────┐  │
│  │ [✓] 另一件商品...          │  │
│  └───────────────────────────┘  │
├─────────────────────────────────┤
│  优惠券选择                      │
│  [选择优惠券 >]                  │
├─────────────────────────────────┤
│  ┌───────────────────────────┐  │
│  │ 合计: ¥999.00             │  │
│  │ [全选] [去结算]           │  │
│  └───────────────────────────┘  │
└─────────────────────────────────┘
```

#### 核心功能
- 商品列表（可选择、删除）
- 数量调整（+/-）
- 全选/反选
- 优惠券选择
- 价格计算
- 去结算

---

### 4. 我的页面 (`/mall/profile.html`) 🔄 待创建

#### 布局结构
```
┌─────────────────────────────────┐
│  用户信息卡片                    │
│  [头像] 用户名                   │
│  会员等级 | 积分: 1234           │
├─────────────────────────────────┤
│  我的订单                        │
│  [待付款] [待发货] [待收货] [已完成] │
├─────────────────────────────────┤
│  活动中心                        │
│  • 每日签到                      │
│  • 空投领取                      │
│  • 我的奖励                      │
├─────────────────────────────────┤
│  我的服务                        │
│  • 收货地址                      │
│  • 优惠券                        │
│  • 客服中心                      │
│  • 设置                          │
└─────────────────────────────────┘
```

#### 核心功能
- 用户信息展示
- 订单管理（4个状态）
- 活动中心入口
- 服务功能入口
- 钱包连接状态
- 退出登录

---

## 🔧 底部导航栏（全局）

### 设计规范
```css
.bottom-nav {
  position: fixed;
  bottom: 0;
  height: 60px + safe-area-inset-bottom;
  background: white;
  border-top: 1px solid #e0e0e0;
  box-shadow: 0 -2px 8px rgba(0,0,0,0.05);
}
```

### 4个导航项
1. **首页** 🏠
   - 图标: `fa-home`
   - 路由: `/mall/`
   - 默认激活

2. **互动** 💬
   - 图标: `fa-comments`
   - 路由: `/mall/community.html`

3. **购物车** 🛒
   - 图标: `fa-shopping-cart`
   - 路由: `/mall/cart.html`
   - 显示数量徽章

4. **我的** 👤
   - 图标: `fa-user`
   - 路由: `/mall/profile.html`

---

## 🎨 设计规范

### 颜色系统
```css
主色调: #9E2A2B (深红)
辅助色: #7a1b1c (深红暗)
强调色: #D5BDAF (米色)
背景色: #f5f5f5 (浅灰)
卡片背景: #ffffff (白色)
文字主色: #333333
文字次色: #666666
文字辅助: #999999
```

### 圆角规范
- 卡片: `12px`
- 按钮: `8px` / `20px`（圆形）
- 输入框: `24px`（搜索框）
- 图片: `8px`

### 间距规范
- 页面边距: `16px`
- 卡片间距: `8px` / `12px`
- 内容间距: `12px` / `16px`
- 网格间距: `12px`

### 字体规范
- 标题: `18px` / `bold`
- 正文: `15px` / `normal`
- 辅助文字: `13px` / `normal`
- 小字: `11px` / `normal`

---

## 📊 产品详情页优化

### 底部操作栏
```
┌─────────────────────────────────┐
│  [首页] [客服] [购物车] [立即购买] │
└─────────────────────────────────┘
```

#### 4个按钮
1. **首页** - 返回商城首页
2. **客服** - 打开客服对话
3. **购物车** - 加入购物车
4. **立即购买** - 直接下单（主要操作）

#### 样式
```css
.product-bottom-bar {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  background: white;
  border-top: 1px solid #e0e0e0;
  padding: 12px 16px;
  display: grid;
  grid-template-columns: auto auto auto 1fr;
  gap: 12px;
}

.icon-btn {
  width: 48px;
  height: 48px;
  border-radius: 50%;
  border: 1px solid #e0e0e0;
}

.buy-btn {
  background: linear-gradient(135deg, #9E2A2B, #7a1b1c);
  color: white;
  border-radius: 24px;
  font-weight: bold;
}
```

---

## 🔄 数据流

### 购物车数据
```javascript
// LocalStorage 存储
const cart = [
  {
    product_id: "id_123",
    title: "商品名称",
    price: 299,
    quantity: 1,
    image: "image_url",
    selected: true
  }
];

// 保存
localStorage.setItem('shopping_cart', JSON.stringify(cart));

// 读取
const cart = JSON.parse(localStorage.getItem('shopping_cart') || '[]');
```

### 用户数据
```javascript
// 从钱包获取
const user = {
  wallet: "0x...",
  name: "用户名",
  avatar: "avatar_url",
  points: 1234,
  level: "VIP"
};
```

---

## 🚀 技术栈

### 前端
- **HTML5** - 语义化标签
- **CSS3** - Grid / Flexbox
- **JavaScript** - ES6+
- **TailwindCSS** - 快速样式
- **Font Awesome** - 图标库
- **Swiper.js** - 轮播组件

### 后端 API
- **Cloudflare Workers** - Serverless API
- **D1 Database** - SQL 数据库
- **R2 Storage** - 对象存储

---

## 📱 响应式设计

### 移动端优先
- 基础布局: 375px - 428px
- 平板: 768px - 1024px
- 桌面: > 1024px

### 适配要点
```css
/* 移动端 */
@media (max-width: 768px) {
  .product-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

/* 桌面端 */
@media (min-width: 1024px) {
  .product-grid {
    grid-template-columns: repeat(4, 1fr);
  }
}
```

---

## ⚡ 性能优化

### 图片优化
- 使用 WebP 格式
- 懒加载（Intersection Observer）
- 响应式图片（srcset）

### 代码优化
- 按需加载
- 代码分割
- 缓存策略

### 用户体验
- 骨架屏加载
- 加载动画
- 错误处理
- 离线提示

---

## 🔐 安全考虑

### 用户认证
- 钱包签名登录
- JWT Token
- 刷新令牌

### 数据安全
- HTTPS 传输
- XSS 防护
- CSRF 防护
- 敏感信息加密

---

## 📈 未来规划

### 短期（1-2周）
- [ ] 完成购物车页面
- [ ] 完成我的页面
- [ ] 实现订单流程
- [ ] 添加支付功能

### 中期（1-2月）
- [ ] 完善社交功能
- [ ] 添加直播功能
- [ ] 实现积分系统
- [ ] 优惠券系统

### 长期（3-6月）
- [ ] AI 推荐系统
- [ ] AR 试穿功能
- [ ] 社区治理
- [ ] 国际化支持

---

## 📝 开发进度

| 模块 | 状态 | 完成度 | 备注 |
|------|------|--------|------|
| 首页 | ✅ 完成 | 100% | 包含所有核心功能 |
| 互动中心 | ✅ 完成 | 90% | 需要后端 API 支持 |
| 购物车 | 🔄 进行中 | 0% | 待创建 |
| 我的页面 | 🔄 进行中 | 0% | 待创建 |
| 底部导航 | ✅ 完成 | 100% | 全局组件 |
| 产品详情 | 🔄 优化中 | 80% | 需要添加底部栏 |

---

## 🎯 总结

新商城系统采用现代化的电商设计理念，提供完整的购物、社交、个人中心功能。通过底部导航栏实现4个主要模块的快速切换，为用户提供流畅的使用体验。

**核心特点**:
- 📱 移动端优先设计
- 🎨 现代化 UI/UX
- ⚡ 高性能加载
- 🔐 安全可靠
- 🌐 Web3 集成

**下一步**: 完成购物车和我的页面，实现完整的电商闭环。

